export default [
    {
        "title": "Home",
        "fileName": "index.html",
        "text": "Home Custom Quote Sync Metadata-driven Quote-Opportunity custom field synchronization (based on Salesforce Labs Custom Quote Sync ) Changelog ToDo items Look at the permission set granted - you'll probably want to fix that. Is it needed? Try to minimize metadata in the package, but ensure that tests have proper coverage when generating the package. Will need to optimize the metadata included(see sfdx-project). General Description This app allows you to configure custom fields mapping between Opportunity and Quote, and custom fields on OpportunityLineItem and QuoteLineItem. The mapped fields will be synchronized automatically similar to the standard Quote Sync process. Configuration What's Included This package comes with some code to sync custom fields between Opportunities and Quotes(and their Line Items), but it needs to know which fields to map between the proper objects. This is achieved via Custom Metadata Types. Indicate the Opportunity and Quote(or Line Item) field names on the correct CMT and the package will do the rest."
    },
    {
        "title": "QuoteSyncHandler",
        "fileName": "QuoteSyncHandler.html",
        "text": "QuoteSyncHandler QuoteSyncHandler class that contains all the logic that uses the QuoteSyncUtil. This class exposes methods to sync the Opportunity, Quote, OpportunityLineItem and QuoteLineItem objects and should ideally be called from each object's trigger Code adapted from QuoteSync AppExchange package, moved to single handler class Signature @SuppressWarnings('PMD.AvoidGLobalModifier') global without sharing class QuoteSyncHandler See QuoteSyncUtil Author Salesforce Labs Since 2014 Original Author Author David Schach Since 2022-08 New trigger handler framework 2022-10 Converted to Custom Metadata 2023-04 Refine Quote Sync with new Quote fields 2023-04 Remove trigger framework, stoppers into this class QuoteSyncHandler Properties Name Signature Description stopOpp public static Boolean stopOpp If true, exit Opportunity  trigger handler stopOppLine public static Boolean stopOppLine If true, exit OppoortunityLineItem  trigger handler stopQuote public static Boolean stopQuote If true, exit Quote  trigger handler stopQuoteLine public static Boolean stopQuoteLine If true, exit QuoteLineItem  trigger handler QuoteSyncHandler Methods bypassAll() Deactivate all QuoteSync triggers clearAllBypasses() Reactivate all QuoteSync triggers getOpportunityLineItemsToUpdate(syncQuoteIds, syncOppIds, startSyncQuoteMap, qliFields, oliFields) Method that takes a set of Quote  Ids, a set of Opportunity  Ids and a map linking them together and returns a list of Opportunity Products  that should be updated to be synced getQuotesToUpdate(oppIds, quoteIds, oppFieldsString, quoteFieldsString, quoteFields) Method that gets a set of Opportunity  Ids, a set of Quote  Ids and returns a list of Quotes  that should be updated to be synced with their corresponding Opportunity getStringFromFieldSet(fields) Method that builds a string of fields separated by a comma to be put into a Database query string syncOppLines(newRecords, oldRecordsMap) Sync Opportunity Products  with Quote Line Items syncOpportunities(newRecords, oldRecordsMap) Sync Opportunities  with Quotes syncQuote(newRecords, oldRecordsMap) Sync Quote  fields with Opportunity  fields syncQuoteLines(newRecords, oldRecordsMap) Sync Quote Line Items  with Opportunity Products bypassAll() Deactivate all QuoteSync triggers Signature public static void bypassAll() clearAllBypasses() Reactivate all QuoteSync triggers Signature public static void clearAllBypasses() getOpportunityLineItemsToUpdate(syncQuoteIds, syncOppIds, startSyncQuoteMap, qliFields, oliFields) Method that takes a set of Quote  Ids, a set of Opportunity  Ids and a map linking them together and returns a list of Opportunity Products  that should be updated to be synced Signature private static Set<OpportunityLineItem> getOpportunityLineItemsToUpdate(\t\tSet<Id> syncQuoteIds,\t\tSet<Id> syncOppIds,\t\tMap<Id, Id> startSyncQuoteMap,\t\tString qliFields,\t\tString oliFields\t) Parameters syncQuoteIds Type: \t\tSet<Id> Set of Quote  Ids syncOppIds Set of Opportunity  Ids startSyncQuoteMap Type: Id> Map that links each Quote  Id with its synced Opportunity  Id qliFields List of QuoteLineItem  fields to be compared oliFields List of OpportunityLineItem  fields to be compared Returns Set<OpportunityLineItem>  that should be updated getQuotesToUpdate(oppIds, quoteIds, oppFieldsString, quoteFieldsString, quoteFields) Method that gets a set of Opportunity  Ids, a set of Quote  Ids and returns a list of Quotes  that should be updated to be synced with their corresponding Opportunity Signature private static List<Quote> getQuotesToUpdate(\t\tSet<Id> oppIds,\t\tSet<Id> quoteIds,\t\tString oppFieldsString,\t\tString quoteFieldsString,\t\tSet<String> quoteFields\t) Parameters oppIds Type: \t\tSet<Id> Set of Opportunity  Ids quoteIds Set of Quote  Ids oppFieldsString List of comma separated  Opportunity  fields to be compared quoteFieldsString List of comma separated quote fields to be compared(in a string) quoteFields List of Quote  fields in a list Returns List<Quote>  That should be updated Author David Schach Since 2022 getStringFromFieldSet(fields) Method that builds a string of fields separated by a comma to be put into a Database query string Signature private String getStringFromFieldSet(Set<String> fields) Parameters fields Type: Set<String> Set of field names Returns String  with the fields separated by commas syncOppLines(newRecords, oldRecordsMap) Sync Opportunity Products  with Quote Line Items Signature global void syncOppLines(List<OpportunityLineItem> newRecords, Map<Id, OpportunityLineItem> oldRecordsMap) Parameters newRecords Type: List<OpportunityLineItem> New OpportunityLineItems  from Trigger.new oldRecordsMap Type: Map<Id, OpportunityLineItem> Old OpportunityLineItems  in a map from Trigger.oldMap Author David Schach Since 2022 Change SOQL to use IN collection, not comma-separated Ids syncOpportunities(newRecords, oldRecordsMap) Sync Opportunities  with Quotes Signature global void syncOpportunities(List<Opportunity> newRecords, Map<Id, Opportunity> oldRecordsMap) Parameters newRecords Type: List<Opportunity> New Opportunities  from Trigger.new oldRecordsMap Type: Map<Id, Opportunity> Old Opportunities  in a map from Trigger.oldMap Author David Schach Since 2022 Change SOQL to use IN collection, not comma-separated Ids syncQuote(newRecords, oldRecordsMap) Sync Quote  fields with Opportunity  fields Signature global void syncQuote(List<Quote> newRecords, Map<Id, Quote> oldRecordsMap) Parameters newRecords Type: List<Quote> New Quotes  from Trigger.new oldRecordsMap Type: Map<Id, Quote> Old Quotes  in a map from Trigger.oldMap Authors Salesforce Labs , David Schach Since 2022 Change SOQL to use IN collection, not comma-separated Ids syncQuoteLines(newRecords, oldRecordsMap) Sync Quote Line Items  with Opportunity Products Signature global void syncQuoteLines(List<QuoteLineItem> newRecords, Map<Id, QuoteLineItem> oldRecordsMap) Parameters newRecords Type: List<QuoteLineItem> New QuoteLineItems  from Trigger.new oldRecordsMap Type: Map<Id, QuoteLineItem> Old QuoteLineItems  in a map from Trigger.oldMap Author David Schach Since 2022 Change SOQL to use IN collection, not comma-separated Ids"
    },
    {
        "title": "QuoteSyncTest",
        "fileName": "QuoteSyncTest.html",
        "text": "QuoteSyncTest Test class for Quote/Opportunity sync Signature @isTest private without sharing class QuoteSyncTest See QuoteSync , QuoteSyncUtil , QuoteSyncHandler Author Salesforce Labs Since 2014 Author David Schach Since 2022-10 Converted to Custom Metadata 2023-04 Lazy load and memoize Standard Pricebook Id QuoteSyncTest Properties Name Signature Description standardPricebookId private static Id standardPricebookId Store the standard pricebook Id QuoteSyncTest Methods assertOppFields(oppId, expectedOpp) assertOppLineFields(oppId, oppLines) assertQuoteFields(quoteId, expectedQuote) assertQuoteLineFields(quoteId, quoteLines) assertQuoteLineNotSync(oppId, quoteId) assertQuoteLineNotSync(oppId, quoteId, isCreate) assertQuoteLineSync(oppId, quoteId) assertQuoteLineSync(oppId, quoteId, sync, isCreate) assertQuoteNotSync(oppId, quoteId, isCreate) assertQuoteNotSync(oppId, quoteId) assertQuoteSync(oppId, quoteId) assertQuoteSync(oppId, quoteId, sync, isCreate) createOpp() createOpp(setNullOrFalse) createOppLines(opp, num) createOppLines(opp, num, unique, setNullOrFalse) createOppLinesNoSync(opp, num) createQuote(opp) createQuote(opp, setNullOrFalse) createQuoteLines(quote, num) createQuoteLines(quote, num, unique, setNullOrFalse) createQuoteLinesNoSync(quote, num) getStandardPricebookId() Memoized version of Test.getStandardPricebookId()  so we call it once and not again in a test makeData() populateField(sobj, entity, field) Given an SObject and a field, fill it populateFields(sobj, entity, fields) Given an SObject and fields, fill them all populateFields(sobj, entity, fields, setNullOrFalse) Given an SObject and fields, fill them printOpp(oppId) Debug method for use in checking unit tests. printOppLines(oppId) Debug method for use in checking unit tests. printQuote(quoteId) Debug method for use in checking unit tests. printQuoteLines(quoteId) Debug method for use in checking unit tests. startSync(oppId, quoteId) Set a specific Quote as the syncing quote stopSync(oppId) Set no Quote to synd with this Opportunity testCreateDuplicateOppLine() Create duplicate Opportunity Product  with from same Price Book Entry testCreateDuplicateQuoteLine() Create duplicate Quote Line Item  with from same Price Book Entry testCreateQuote() Create quote from Opportunity . Verify Quote  sync fields are copied from opp testCreateQuoteWithQuoteLine() Create quote from opp with Opportunity Product . Verify Quote Line Item  sync fields are copied from Opportunity Product testInsertOppLineNoSync() Insert Opportunity Product  without sync fields. Verify fields on Quote Line Item  are synced. testInsertOppLineNotSync() Insert Opportunity Product  when opp is not synced with Quote testInsertOppLineSync() Insert Opportunity Product  with sync fields set. Verify corresponding fields on Quote Line Item  are synced. testInsertQuoteLineNoSync() Insert Quote Line Item  without sync fields. Verify corresponding fields on Opportunity Product  are not synced. testInsertQuoteLineNotSync() Insert Quote Line Item  when Quote  is not synced with Opportunity . testInsertQuoteLineSync() Insert Quote Line Item  with sync fields. Verify corresponding fields on Opportunity Product  are synced. testStartSyncInsertOppLine() Start sync from quote with QuoteLineItems  create new OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncInsertOppLineSetNull() Start sync from quote with QuoteLineItems  create new OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine1() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine1a() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine2() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine2a() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine3() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine3a() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine4() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine4a() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine5() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine6() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine7() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncMatchOppLine7a() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncOtherQuote() Start sync from another quote. Verify opp and Opportunity Product  fields are synced from new quote and Quote Line Item testStartSyncQuote() Start sync from quote. Verify opp fields are synced from quote testStartSyncQuoteSetNull() Start sync from quote. Verify opp fields are synced from quote testStartSyncUpdateOppLine() Start sync from quote with QuoteLineItems  update existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncUpdateOppLineSetNull() Start sync from quote with QuoteLineItems  update existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced testStartSyncWithQuoteLine() Start sync from quote with Quote Line Item . Verify Opportunity Product  fields are synced from Quote Line Item testStartSyncWithQuoteLineSetNull() Start sync from quote with Quote Line Item . Verify Opportunity Product  fields are synced from Quote Line Item testStopSync() Stop sync on verify no changeson Opportunity  & Opportunity Product , quote & Quote Line Item  fields testUpdateDuplicateOppLine() Update duplicate Opportunity Product  with from same Price Book Entry testUpdateDuplicateQuoteLine() Update duplicate Quote Line Item  with from same Price Book Entry testUpdateOppLineNoSync() Update Opportunity Product  non-sync fields. Verify fields on Quote Line Item  are not updated. testUpdateOppLineNotSync() Update Opportunity Product  when opp not synced with Quote . testUpdateOppLineSync1() Update Opportunity Product  sync fields. Verify corresponding fields on Quote Line Item  are updated. testUpdateOppLineSync2() Update Opportunity Product  standard fields. Verify corresponding fields on Quote Line Item  are updated. testUpdateOppLineSync3() Update Opportunity Product  sync fields. Verify corresponding fields on Quote Line Item  are updated. testUpdateOppLineSyncSetNull() Update Opportunity Product  sync fields to null. Verify corresponding fields on Quote Line Item  are updated. testUpdateOppNoSync() Update opp non-sync fields. Verify fields on Quote  are not updated. testUpdateOppNotSync() Update Opportunity  when it's is not synced with Quote . testUpdateOppSync() Update 'Opportunity' sync fields. Verify corresponding fields on Quote  are updated. testUpdateOppSyncSetNull() Update 'Opportunity' sync fields. Verify corresponding fields on Quote  are updated. testUpdateQuoteLineNoSync() Update Quote Line Item  non-sync fields. Verify corresponding fields on Opportunity Product  are not updated. testUpdateQuoteLineNotSync() Update Quote Line Item  when Quote  not synced with Opportunity . testUpdateQuoteLineSync1() Update Quote Line Item  sync fields. Verify corresponding fields on Opportunity Product  are updated. testUpdateQuoteLineSync2() Update Quote Line Item  sync fields. Verify corresponding fields on Opportunity Product  are updated. testUpdateQuoteLineSync3() Update Quote Line Item  sync fields. Verify corresponding fields on Opportunity Product  are updated. testUpdateQuoteLineSyncSetNull() Update Quote Line Item  sync fields. Verify corresponding fields on Opportunity Product  are updated. testUpdateQuoteNoSync() Update Quote  non-sync fields. Verify corresponding fieldson Opportunity  are not updated. testUpdateQuoteNotSync() Update Quote  when it's not synced with Opportunity . testUpdateQuoteSync() Update Quote  sync fields. Verify corresponding fieldson Opportunity  are updated. testUpdateQuoteSyncSetNull() Update Quote  sync fields. Verify corresponding fieldson Opportunity  are updated. updateOpp(oppId) updateOpp(oppId, updateNullOrFalse) updateOppLines(oppId) updateOppLines(oppId, stdSyncField, customSyncField) updateOppLines(oppId, stdSyncField, customSyncField, updateNullOrFalse) updateOppLinesCustomSyncFields(oppId) updateOppLinesNoSync(oppId, field) updateOppLinesStdSyncFields(oppId) updateOppNoSync(oppId) updateQuote(quoteId) Re-fill Quote fields and updateOpp(oppId) updateQuote(quoteId, updateNullOrFalse) Re-fill Quote fields and updateOpp(oppId) updateQuoteLines(quoteId) updateQuoteLines(quoteId, stdSyncField, customSyncField) updateQuoteLines(quoteId, stdSyncField, customSyncField, updateNullOrFalse) updateQuoteLinesCustomSyncFields(quoteId) updateQuoteLinesNoSync(quoteId, field) updateQuoteLinesStdSyncFields(quoteId) updateQuoteNoSync(quoteId) assertOppFields(oppId, expectedOpp) Signature private static Boolean assertOppFields(Id oppId, Opportunity expectedOpp) assertOppLineFields(oppId, oppLines) Signature private static Boolean assertOppLineFields(Id oppId, List<OpportunityLineItem> oppLines) assertQuoteFields(quoteId, expectedQuote) Signature private static Boolean assertQuoteFields(Id quoteId, Quote expectedQuote) assertQuoteLineFields(quoteId, quoteLines) Signature private static Boolean assertQuoteLineFields(Id quoteId, List<QuoteLineItem> quoteLines) assertQuoteLineNotSync(oppId, quoteId) Signature private static Boolean assertQuoteLineNotSync(Id oppId, Id quoteId) assertQuoteLineNotSync(oppId, quoteId, isCreate) Signature private static Boolean assertQuoteLineNotSync(Id oppId, Id quoteId, Boolean isCreate) assertQuoteLineSync(oppId, quoteId) Signature private static Boolean assertQuoteLineSync(Id oppId, Id quoteId) assertQuoteLineSync(oppId, quoteId, sync, isCreate) Signature private static Boolean assertQuoteLineSync(Id oppId, Id quoteId, Boolean sync, Boolean isCreate) assertQuoteNotSync(oppId, quoteId, isCreate) Signature private static Boolean assertQuoteNotSync(Id oppId, Id quoteId, Boolean isCreate) assertQuoteNotSync(oppId, quoteId) Signature private static Boolean assertQuoteNotSync(Id oppId, Id quoteId) assertQuoteSync(oppId, quoteId) Signature private static Boolean assertQuoteSync(Id oppId, Id quoteId) assertQuoteSync(oppId, quoteId, sync, isCreate) Signature private static Boolean assertQuoteSync(Id oppId, Id quoteId, Boolean sync, Boolean isCreate) createOpp() Signature private static Opportunity createOpp() createOpp(setNullOrFalse) Signature private static Opportunity createOpp(Boolean setNullOrFalse) createOppLines(opp, num) Signature private static List<OpportunityLineItem> createOppLines(Opportunity opp, Integer num) createOppLines(opp, num, unique, setNullOrFalse) Signature private static List<OpportunityLineItem> createOppLines(Opportunity opp, Integer num, Boolean unique, Boolean setNullOrFalse) createOppLinesNoSync(opp, num) Signature private static List<OpportunityLineItem> createOppLinesNoSync(Opportunity opp, Integer num) createQuote(opp) Signature private static Quote createQuote(Opportunity opp) createQuote(opp, setNullOrFalse) Signature private static Quote createQuote(Opportunity opp, Boolean setNullOrFalse) createQuoteLines(quote, num) Signature private static List<QuoteLineItem> createQuoteLines(Quote quote, Integer num) createQuoteLines(quote, num, unique, setNullOrFalse) Signature private static List<QuoteLineItem> createQuoteLines(Quote quote, Integer num, Boolean unique, Boolean setNullOrFalse) createQuoteLinesNoSync(quote, num) Signature private static List<QuoteLineItem> createQuoteLinesNoSync(Quote quote, Integer num) getStandardPricebookId() Memoized version of Test.getStandardPricebookId()  so we call it once and not again in a test Signature public static Id getStandardPricebookId() Returns Id  Standard Pricebook Id makeData() Signature @TestSetup private static void makeData() populateField(sobj, entity, field) Given an SObject and a field, fill it Signature private static void populateField(SObject sobj, String entity, String field) Parameters sobj Type: SObject The SObject record entity Type: String The name of the SObject(its type) field Type: String The field to populate/update populateFields(sobj, entity, fields) Given an SObject and fields, fill them all Signature private static void populateFields(SObject sobj, String entity, Set<String> fields) Parameters sobj Type: SObject The SObject record entity Type: String The name of the SObject(its type) fields Type: Set<String> All fields to populate/update populateFields(sobj, entity, fields, setNullOrFalse) Given an SObject and fields, fill them Signature private static void populateFields(SObject sobj, String entity, Set<String> fields, Boolean setNullOrFalse) Parameters sobj Type: SObject The SObject record entity Type: String The name of the SObject(its type) fields Type: Set<String> All fields to populate/update setNullOrFalse Type: Boolean If true, set field to null(or Boolean to false) printOpp(oppId) Debug method for use in checking unit tests. Signature private static void printOpp(Id oppId) Parameters oppId Type: Id The Opportunity  to debug Example printOpp(opp.Id); printOppLines(oppId) Debug method for use in checking unit tests. Signature private static void printOppLines(Id oppId) Parameters oppId Type: Id The Opportunity  to debug Example printOppLines(opp.Id); printQuote(quoteId) Debug method for use in checking unit tests. Signature private static void printQuote(Id quoteId) Parameters quoteId Type: Id The Quote  to debug Example printQuote(quote.Id); printQuoteLines(quoteId) Debug method for use in checking unit tests. Signature private static void printQuoteLines(Id quoteId) Parameters quoteId Type: Id The Quote  to debug Example printQuoteLines(quote.Id) startSync(oppId, quoteId) Set a specific Quote as the syncing quote Signature private static void startSync(Id oppId, Id quoteId) Parameters oppId Type: Id Opportunity Id quoteId Type: Id Quote Id(to set as syncing quote) stopSync(oppId) Set no Quote to synd with this Opportunity Signature private static void stopSync(Id oppId) Parameters oppId Type: Id Opportunity Id testCreateDuplicateOppLine() Create duplicate Opportunity Product  with from same Price Book Entry Signature @isTest private static void testCreateDuplicateOppLine() testCreateDuplicateQuoteLine() Create duplicate Quote Line Item  with from same Price Book Entry Signature @isTest private static void testCreateDuplicateQuoteLine() testCreateQuote() Create quote from Opportunity . Verify Quote  sync fields are copied from opp Signature @isTest private static void testCreateQuote() testCreateQuoteWithQuoteLine() Create quote from opp with Opportunity Product . Verify Quote Line Item  sync fields are copied from Opportunity Product Signature @isTest private static void testCreateQuoteWithQuoteLine() testInsertOppLineNoSync() Insert Opportunity Product  without sync fields. Verify fields on Quote Line Item  are synced. Signature @isTest private static void testInsertOppLineNoSync() testInsertOppLineNotSync() Insert Opportunity Product  when opp is not synced with Quote Signature @isTest private static void testInsertOppLineNotSync() testInsertOppLineSync() Insert Opportunity Product  with sync fields set. Verify corresponding fields on Quote Line Item  are synced. Signature @isTest private static void testInsertOppLineSync() testInsertQuoteLineNoSync() Insert Quote Line Item  without sync fields. Verify corresponding fields on Opportunity Product  are not synced. Signature @isTest private static void testInsertQuoteLineNoSync() testInsertQuoteLineNotSync() Insert Quote Line Item  when Quote  is not synced with Opportunity . Signature @isTest private static void testInsertQuoteLineNotSync() testInsertQuoteLineSync() Insert Quote Line Item  with sync fields. Verify corresponding fields on Opportunity Product  are synced. Signature @isTest private static void testInsertQuoteLineSync() testStartSyncInsertOppLine() Start sync from quote with QuoteLineItems  create new OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncInsertOppLine() testStartSyncInsertOppLineSetNull() Start sync from quote with QuoteLineItems  create new OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncInsertOppLineSetNull() testStartSyncMatchOppLine1() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine1() testStartSyncMatchOppLine1a() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine1a() testStartSyncMatchOppLine2() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine2() testStartSyncMatchOppLine2a() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine2a() testStartSyncMatchOppLine3() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine3() testStartSyncMatchOppLine3a() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine3a() testStartSyncMatchOppLine4() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine4() testStartSyncMatchOppLine4a() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine4a() testStartSyncMatchOppLine5() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine5() testStartSyncMatchOppLine6() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine6() testStartSyncMatchOppLine7() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine7() testStartSyncMatchOppLine7a() Start sync from quote with QuoteLineItems  that match existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncMatchOppLine7a() testStartSyncOtherQuote() Start sync from another quote. Verify opp and Opportunity Product  fields are synced from new quote and Quote Line Item Signature @isTest private static void testStartSyncOtherQuote() testStartSyncQuote() Start sync from quote. Verify opp fields are synced from quote Signature @isTest private static void testStartSyncQuote() testStartSyncQuoteSetNull() Start sync from quote. Verify opp fields are synced from quote Signature @isTest private static void testStartSyncQuoteSetNull() testStartSyncUpdateOppLine() Start sync from quote with QuoteLineItems  update existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncUpdateOppLine() testStartSyncUpdateOppLineSetNull() Start sync from quote with QuoteLineItems  update existing OpportunityLineItems  on Opportunity . Verify Opportunity Product  fields are synced Signature @isTest private static void testStartSyncUpdateOppLineSetNull() testStartSyncWithQuoteLine() Start sync from quote with Quote Line Item . Verify Opportunity Product  fields are synced from Quote Line Item Signature @isTest private static void testStartSyncWithQuoteLine() testStartSyncWithQuoteLineSetNull() Start sync from quote with Quote Line Item . Verify Opportunity Product  fields are synced from Quote Line Item Signature @isTest private static void testStartSyncWithQuoteLineSetNull() testStopSync() Stop sync on verify no changeson Opportunity  & Opportunity Product , quote & Quote Line Item  fields Signature @isTest private static void testStopSync() testUpdateDuplicateOppLine() Update duplicate Opportunity Product  with from same Price Book Entry Signature @isTest private static void testUpdateDuplicateOppLine() testUpdateDuplicateQuoteLine() Update duplicate Quote Line Item  with from same Price Book Entry Signature @isTest private static void testUpdateDuplicateQuoteLine() testUpdateOppLineNoSync() Update Opportunity Product  non-sync fields. Verify fields on Quote Line Item  are not updated. Signature @isTest private static void testUpdateOppLineNoSync() testUpdateOppLineNotSync() Update Opportunity Product  when opp not synced with Quote . Signature @isTest private static void testUpdateOppLineNotSync() testUpdateOppLineSync1() Update Opportunity Product  sync fields. Verify corresponding fields on Quote Line Item  are updated. Signature @isTest private static void testUpdateOppLineSync1() testUpdateOppLineSync2() Update Opportunity Product  standard fields. Verify corresponding fields on Quote Line Item  are updated. Signature @isTest private static void testUpdateOppLineSync2() testUpdateOppLineSync3() Update Opportunity Product  sync fields. Verify corresponding fields on Quote Line Item  are updated. Signature @isTest private static void testUpdateOppLineSync3() testUpdateOppLineSyncSetNull() Update Opportunity Product  sync fields to null. Verify corresponding fields on Quote Line Item  are updated. Signature @isTest private static void testUpdateOppLineSyncSetNull() testUpdateOppNoSync() Update opp non-sync fields. Verify fields on Quote  are not updated. Signature @isTest private static void testUpdateOppNoSync() testUpdateOppNotSync() Update Opportunity  when it's is not synced with Quote . Signature @isTest private static void testUpdateOppNotSync() testUpdateOppSync() Update 'Opportunity' sync fields. Verify corresponding fields on Quote  are updated. Signature @isTest private static void testUpdateOppSync() testUpdateOppSyncSetNull() Update 'Opportunity' sync fields. Verify corresponding fields on Quote  are updated. Signature @isTest private static void testUpdateOppSyncSetNull() testUpdateQuoteLineNoSync() Update Quote Line Item  non-sync fields. Verify corresponding fields on Opportunity Product  are not updated. Signature @isTest private static void testUpdateQuoteLineNoSync() testUpdateQuoteLineNotSync() Update Quote Line Item  when Quote  not synced with Opportunity . Signature @isTest private static void testUpdateQuoteLineNotSync() testUpdateQuoteLineSync1() Update Quote Line Item  sync fields. Verify corresponding fields on Opportunity Product  are updated. Signature @isTest private static void testUpdateQuoteLineSync1() testUpdateQuoteLineSync2() Update Quote Line Item  sync fields. Verify corresponding fields on Opportunity Product  are updated. Signature @isTest private static void testUpdateQuoteLineSync2() testUpdateQuoteLineSync3() Update Quote Line Item  sync fields. Verify corresponding fields on Opportunity Product  are updated. Signature @isTest private static void testUpdateQuoteLineSync3() testUpdateQuoteLineSyncSetNull() Update Quote Line Item  sync fields. Verify corresponding fields on Opportunity Product  are updated. Signature @isTest private static void testUpdateQuoteLineSyncSetNull() testUpdateQuoteNoSync() Update Quote  non-sync fields. Verify corresponding fieldson Opportunity  are not updated. Signature @isTest private static void testUpdateQuoteNoSync() testUpdateQuoteNotSync() Update Quote  when it's not synced with Opportunity . Signature @isTest private static void testUpdateQuoteNotSync() testUpdateQuoteSync() Update Quote  sync fields. Verify corresponding fieldson Opportunity  are updated. Signature @isTest private static void testUpdateQuoteSync() testUpdateQuoteSyncSetNull() Update Quote  sync fields. Verify corresponding fieldson Opportunity  are updated. Signature @isTest private static void testUpdateQuoteSyncSetNull() updateOpp(oppId) Signature private static Opportunity updateOpp(Id oppId) updateOpp(oppId, updateNullOrFalse) Signature private static Opportunity updateOpp(Id oppId, Boolean updateNullOrFalse) updateOppLines(oppId) Signature private static List<OpportunityLineItem> updateOppLines(Id oppId) updateOppLines(oppId, stdSyncField, customSyncField) Signature private static List<OpportunityLineItem> updateOppLines(Id oppId, Boolean stdSyncField, Boolean customSyncField) updateOppLines(oppId, stdSyncField, customSyncField, updateNullOrFalse) Signature private static List<OpportunityLineItem> updateOppLines(Id oppId, Boolean stdSyncField, Boolean customSyncField, Boolean updateNullOrFalse) updateOppLinesCustomSyncFields(oppId) Signature private static List<OpportunityLineItem> updateOppLinesCustomSyncFields(Id oppId) updateOppLinesNoSync(oppId, field) Signature private static List<OpportunityLineItem> updateOppLinesNoSync(Id oppId, String field) updateOppLinesStdSyncFields(oppId) Signature private static List<OpportunityLineItem> updateOppLinesStdSyncFields(Id oppId) updateOppNoSync(oppId) Signature private static Opportunity updateOppNoSync(Id oppId) updateQuote(quoteId) Re-fill Quote fields and updateOpp(oppId) Signature private static Quote updateQuote(Id quoteId) Parameters quoteId Type: Id Quote Id Returns Quote  the updated Quote See updateQuote updateQuote(quoteId, updateNullOrFalse) Re-fill Quote fields and updateOpp(oppId) Signature private static Quote updateQuote(Id quoteId, Boolean updateNullOrFalse) Parameters quoteId Type: Id Quote Id updateNullOrFalse Type: Boolean Returns Quote  the updated Quote See updateQuote updateQuoteLines(quoteId) Signature private static List<QuoteLineItem> updateQuoteLines(Id quoteId) updateQuoteLines(quoteId, stdSyncField, customSyncField) Signature private static List<QuoteLineItem> updateQuoteLines(Id quoteId, Boolean stdSyncField, Boolean customSyncField) updateQuoteLines(quoteId, stdSyncField, customSyncField, updateNullOrFalse) Signature private static List<QuoteLineItem> updateQuoteLines(Id quoteId, Boolean stdSyncField, Boolean customSyncField, Boolean updateNullOrFalse) updateQuoteLinesCustomSyncFields(quoteId) Signature private static List<QuoteLineItem> updateQuoteLinesCustomSyncFields(Id quoteId) updateQuoteLinesNoSync(quoteId, field) Signature private static List<QuoteLineItem> updateQuoteLinesNoSync(Id quoteId, String field) updateQuoteLinesStdSyncFields(quoteId) Signature private static List<QuoteLineItem> updateQuoteLinesStdSyncFields(Id quoteId) updateQuoteNoSync(quoteId) Signature private static Quote updateQuoteNoSync(Id quoteId)"
    },
    {
        "title": "QuoteSyncUtil",
        "fileName": "QuoteSyncUtil.html",
        "text": "QuoteSyncUtil Open-source version of Quote-Opportunity Sync Signature public class QuoteSyncUtil See QuoteSync Author Salesforce Labs Since 2014 Original Author Author David Schach Since 2022-10 Converted to Custom Metadata 2023 Refine Quote Sync with new Quote fields QuoteSyncUtil Properties Name Signature Description gd private static Map<String, Schema.SObjectType> gd Global describe - memoized newQuoteIds private static Set<Id> newQuoteIds Set of all new Quote Ids, maintained for the trigger handler OPP_FIELDS private static final Map<String, SObjectField> OPP_FIELDS All Opportunity  fields OPP_LINE_FIELDS private static final Map<String, SObjectField> OPP_LINE_FIELDS All OpportunityLineItem  fields oppLineRequiredFields public static Map<String, Schema.DescribeFieldResult> oppLineRequiredFields Custom, non-synced fields oppRequiredFields public static Map<String, Schema.DescribeFieldResult> oppRequiredFields Custom, non-synced fields QUOTE_FIELDS private static final Map<String, SObjectField> QUOTE_FIELDS All Quote  fields QUOTE_LINE_FIELDS private static final Map<String, SObjectField> QUOTE_LINE_FIELDS All QuoteLineItem  fields quoteFieldMap private static Map<String, String> quoteFieldMap Map Quote  field => Opportunity  for syncing quoteLineFieldMap private static Map<String, String> quoteLineFieldMap Map QuoteLineItem  field => OpportunityLineItem  for syncing quoteLineRequiredFields public static Map<String, Schema.DescribeFieldResult> quoteLineRequiredFields Custom, non-synced fields quoteRequiredFields public static Map<String, Schema.DescribeFieldResult> quoteRequiredFields Custom, non-synced fields standardOppFields private static Set<String> standardOppFields standardOppLineItemFields private static Set<String> standardOppLineItemFields standardQuoteFields private static Set<String> standardQuoteFields standardQuoteLineItemFields private static Set<String> standardQuoteLineItemFields QuoteSyncUtil Methods addNewQuoteId(id) Add an ID to the newQuoteIds  set addQuoteField(quoteField, oppField) addQuoteLineField(qliField, oliField) Add a QuoteLineItem field to the fields to sync clearNewQuoteIds() Remove all Ids from the newQuoteIds  set createValue(sobj, entity, field, result, setNullOrFalse) Create a standard value for each field in our org. This could be done more elegantly with fewer parameters, but it is effective like this. getCustomRequiredFields(entity) Collect all custom fields for an object, and skip fields we need to sync. We may be able to memoize this, but since it's not called directly, there's low risk getField(entity, field) Given an object and field, return the Schema.DescribeFieldResult getNewQuoteIds() getter for newQuoteIds  variable getOppFields() return quoteFieldMap  values as a set getOppFieldsString() Join quoteFieldMap  values(Opportunity  fields) with commas getOppLineFields() return quoteLineFieldMap  values as a set getOppLineFieldsString() getQuoteFieldMapTo(quoteField) Given a Quote  field, find the mapped Opportunity  field getQuoteFields() return quoteFieldMap  keyset getQuoteFieldsString() Join quoteFieldMap  keyset with commas getQuoteLineFieldMapTo(quoteLineField) Given a QuoteLineItem  field, find the mapped Opportunity  field getQuoteLineFields() return quoteLineFieldMap  keyset getQuoteLineFieldsString() Concatenate all mapped QuoteLineItem fields with a comma isNewQuote(id) Does the set newQuoteIds  contain this Id? populateRequiredFields(sobj) Create a value for each custom field we are not syncing removeAllNewQuoteIds(ids) Remove specific Ids from the newQuoteIds  set removeNewQuoteId(id) Remove an ID from the newQuoteIds  set removeQuoteField(quoteField) Remove a Quote field from the Quote fields to sync May be removed, as not asserted in test class removeQuoteLineField(qliField) Remove a QuoteLineItem field from the fields to sync May be removed, as not asserted in test class addNewQuoteId(id) Add an ID to the newQuoteIds  set Signature public static void addNewQuoteId(Id id) Parameters id Type: Id Quote Id to remove addQuoteField(quoteField, oppField) Signature public static String addQuoteField(String quoteField, String oppField) Parameters quoteField Type: String Quote field name oppField Type: String Opp field name Returns String addQuoteLineField(qliField, oliField) Add a QuoteLineItem field to the fields to sync Signature public static void addQuoteLineField(String qliField, String oliField) Parameters qliField Type: String Quote Line field name oliField Type: String Opp Line field name clearNewQuoteIds() Remove all Ids from the newQuoteIds  set Signature public static void clearNewQuoteIds() Deprecated Unused createValue(sobj, entity, field, result, setNullOrFalse) Create a standard value for each field in our org. This could be done more elegantly with fewer parameters, but it is effective like this. Signature public static Object createValue(SObject sobj, String entity, String field, Schema.DescribeFieldResult result, Boolean setNullOrFalse) Parameters sobj Type: SObject SObject(not the object name) entity Type: String Object Name field Type: String Field Name result Type: Schema.DescribeFieldResult Passed DescribeFieldResult setNullOrFalse Type: Boolean If true, set field to null(or Boolean to false) Returns Object getCustomRequiredFields(entity) Collect all custom fields for an object, and skip fields we need to sync. We may be able to memoize this, but since it's not called directly, there's low risk Signature public static Map<String, Schema.DescribeFieldResult> getCustomRequiredFields(String entity) Parameters entity Type: String Object name - Quote, Opportunity, QuoteLineItem, or OpportunityLineItem Returns For the given object, a list of field describe results(minus our synced non-Boolean fields) getField(entity, field) Given an object and field, return the Schema.DescribeFieldResult Signature public static Schema.DescribeFieldResult getField(String entity, String field) Parameters entity Type: String Object name field Type: String Field name Returns Schema.DescribeFieldResult getNewQuoteIds() getter for newQuoteIds  variable Signature public static Set<Id> getNewQuoteIds() Returns Set<Id>  newQuoteIds getOppFields() return quoteFieldMap  values as a set Signature public static Set<String> getOppFields() Returns Set<String>  all Opp fields in CMT records getOppFieldsString() Join quoteFieldMap  values(Opportunity  fields) with commas Signature public static String getOppFieldsString() Returns Opportunity fields separated by commas getOppLineFields() return quoteLineFieldMap  values as a set Signature public static Set<String> getOppLineFields() Returns Set<String>  all OpportunityLineItem  fields in CMT records getOppLineFieldsString() Signature public static String getOppLineFieldsString() Returns String getQuoteFieldMapTo(quoteField) Given a Quote  field, find the mapped Opportunity  field Signature public static String getQuoteFieldMapTo(String quoteField) Parameters quoteField Type: String Quote field name Returns String  Opportunity field mapped from provided Quote field getQuoteFields() return quoteFieldMap  keyset Signature public static Set<String> getQuoteFields() Returns Set<String>  all Quote  fields in CMT records getQuoteFieldsString() Join quoteFieldMap  keyset with commas Signature public static String getQuoteFieldsString() Returns Quote fields separated by commas getQuoteLineFieldMapTo(quoteLineField) Given a QuoteLineItem  field, find the mapped Opportunity  field Signature public static String getQuoteLineFieldMapTo(String quoteLineField) Parameters quoteLineField Type: String QuoteLineItem field name Returns String  Opportunity  field name getQuoteLineFields() return quoteLineFieldMap  keyset Signature public static Set<String> getQuoteLineFields() Returns Set<String>  all QuoteLineItem  fields in CMT records getQuoteLineFieldsString() Concatenate all mapped QuoteLineItem fields with a comma Signature public static String getQuoteLineFieldsString() Returns String  Comma-separated list of QuoteLineItem fields isNewQuote(id) Does the set newQuoteIds  contain this Id? Signature public static Boolean isNewQuote(Id id) Parameters id Type: Id QuoteId Returns Boolean  newQuoteIds.contains(id); populateRequiredFields(sobj) Create a value for each custom field we are not syncing Signature public static void populateRequiredFields(SObject sobj) Parameters sobj Type: SObject Sobject record - Quote, Opportunity, QuoteLineItem, or OpportunityLineItem removeAllNewQuoteIds(ids) Remove specific Ids from the newQuoteIds  set Signature public static void removeAllNewQuoteIds(Set<Id> ids) Parameters ids Type: Set<Id> Quote IDs to remove removeNewQuoteId(id) Remove an ID from the newQuoteIds  set Signature public static void removeNewQuoteId(Id id) Deprecated Unused Parameters id Type: Id Quote Id removeQuoteField(quoteField) Remove a Quote field from the Quote fields to sync May be removed, as not asserted in test class Signature public static String removeQuoteField(String quoteField) Deprecated Unused Parameters quoteField Type: String Quote field name Returns String  The field name removeQuoteLineField(qliField) Remove a QuoteLineItem field from the fields to sync May be removed, as not asserted in test class Signature public static String removeQuoteLineField(String qliField) Parameters qliField Type: String Quote Line field name Returns String  The field name"
    }
];
